\chapter{Computing Solutions to Non-linear Equations}

So far, we are computing solutions using direct methods -- we follow an algorithm, and after a fixed number of steps, we obtain a solution. However, to solve for non-linear equations, we need to apply an indirect, iterative method.

\section{Roots of a Function}

Determine the roots of a general equation of the form \( f(x) = 0 \). That is, find \( x^\ast \) such that \( f(x^\ast) = 0 \).

\begin{note}
    We stick with \( f: \R \to \R \).
\end{note}

How to know when a root must exist? We use the Intermediate Value Theorem (IVT).

\begin{theorem}[Intermediate Value Theorem]
    For a continuous function \( f \in C[a, b] \), if \( v \) is any number between \( f(a) \) and \( f(b) \), then there exists a number \( c \in [a, b] \) such that \( f(c) = v \).
\end{theorem}

\begin{remark}
    \( c \) has to exist, but does \textbf{not} have to be unique.
\end{remark}

We could apply IVT to obtain the following algorithm:
\begin{itemize}
    \item \( x = L \), \( x = R \), \( L < R \)
    \item \( f(L) \) and \( f(R) \) have opposite signs, i.e. \( f(L) \cdot f(R) < 0 \)
    \item By IVT, there has to be a root \( x^\ast \) in the interval \( [L, R] \) with \( f(x^\ast) = 0 \)
\end{itemize}

\begin{example}
    Consider \[
        f(x) = \cos(x) - x \qquad x \in [0, \pi/2]
    \]

    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \draw[->] (-1, 0) -- (2, 0) node[right] {\( x \)};
            \draw[->] (0, -2) -- (0, 1.2) node[above] {\( f(x) \)};

            \draw[domain=0:pi/2, smooth, variable=\x, blue] plot (\x, {cos(\x r) - \x});

            \draw[red] (pi/8, 0) -- (pi/8, {cos(pi/8 r) - pi/8}) node[black,above] {\( \frac{\pi}{8} \)};
            \draw[red] (pi/4, {cos(pi/4 r) - pi/4}) -- (pi/4, 0) node[black,below] {\( \frac{\pi}{4} \)};
        \end{tikzpicture}
    \end{figure}

    We have
    \begin{itemize}
        \item \( f(0) = 1 \), \( f(\pi/2) = -\pi/2 \)
        \item \( f(x) \) is continuous
    \end{itemize}

    By IVT, there exists a root \( x^\ast \) in the interval \( [0, \pi/2] \) such that \( f(x^\ast) = 0 \).

        {~~~}

    \begin{enumerate}
        \item Consider the midpoint of \( [0, \pi/2] \), \[
                  m_1 = L + \frac{1}{2}(R - L) = \frac{\pi}{4}
              \] and we approximate \( x^\ast \) by \( m_1 = \frac{\pi}{4} \). Our error is bounded by \[
                  e_1 = | m_1 - x^\ast | \leq \frac{1}{2} | R - L | = \frac{\pi}{4} \doteq 0.785
              \]
              If we evaluate \( f(\pi / 4) \), we get \[
                  f(\pi / 4) = \cos(\pi / 4) - \frac{\pi}{4} = \frac{\sqrt{2}}{2} - \frac{\pi}{4} \doteq 0.07829
              \] which is not close to 0. We need to refine our estimate.

        \item We observe that if we shrink the interval, we can get a better estimate.

              By IVT, there must be a root between \( [0, \pi/4] \). We have \[
                  m_2 = \frac{\pi}{8}
              \] and the error is bounded by \[
                  e_2 = | m_2 - x^\ast | \leq \frac{1}{2} | R - L | = \frac{\pi}{8} \doteq 0.393
              \]
              Evaluating \( f(\pi / 8) \), we get \[
                  f(\pi / 8) = \cos(\pi / 8) - \frac{\pi}{8} \doteq 0.5312
              \] and by IVT, there must be a root between \( [\pi/8, \pi/4] \).
    \end{enumerate}

    \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c|c|c|c|c}
            Iteration & \( L_i \)    & \( R_i \)    & \( m_i \)
                      & \( f(L_i) \) & \( f(R_i) \) & \( f(m_i) \) \\ \hline
            \(1\)     & \(0\)        & \(\pi/2\)    & \(\pi/4\)
                      & \(+\)        & \(+\)        & \( -0.078 \) \\
            \(2\)     & \(0\)        & \(\pi/4\)    & \(\pi/8\)
                      & \(+\)        & \(-\)        & \( +0.531 \) \\
            \(3\)     & \(\pi/8\)    & \(\pi/4\)    & \(3\pi/16\)
                      & \(+\)        & \(-\)        & \( +0.242 \) \\
            \(4\)     & \(\pi/8\)    & \(3\pi/16\)  & \(5\pi/32\)
                      & \(+\)        & \(-\)        & \( +0.086 \) \\
            etc.
        \end{tabular}
        \caption{Iteration table for the \( [L_i, R_i] \) intervals}
    \end{table}
    Our error in approximating \( x^\ast \) by \( m_i \) is given by \[
        e_i \leq \frac{1}{2} | R_i - L_i |
    \]
    When do we terminate the algorithm?

    \begin{enumerate}
        \item we can stop when the bound on the error is sufficiently small, \[
                  \frac{1}{2} | R_i - L_i | \leq \text{ABS\_TOL}
              \] We take the approximation of the root as \[
                  x^\ast = L_i + \frac{1}{2} (R_i - L_i)
              \]
        \item We could also stop when a maximum number of iterations is reached.
        \item We could also defined a relative tolerance instead of an absolute tolerance, \[
                  \frac{1}{2} | R_i - L_i | \leq \text{REL\_TOL} \cdot | x^\ast |
              \]
        \item We could also stop when \( f(m) \) is small enough

              Note that we could be tricked, as we could have \( f(a) \), but \( | a - x^\ast | \) not necessarily small.
    \end{enumerate}

    In practice, we often combine \( 1 \) and \( 4 \).
\end{example}

\section{Bisection Method}

Suppose we are given a continuous function \( f(x) \) and \( L, R \) such that \( L < R \), \[
    f(L) \cdot f(R) < 0
\]

\begin{algorithm}
    \begin{algorithmic}[1]
        \While {\( \frac{1}{2} | R - L | > \text{ABS\_TOL} \)}
        \State \( M \gets (R + L) / 2 \)
        \If {\Call{Sign}{\(f(L)\)} == \Call{Sign}{\(f(m)\)}}
        \State \( L \gets M \)
        \Else
        \State \( R \gets M \)
        \EndIf
        \EndWhile
        \State \( x^\ast \gets L + (R - L) / 2 \)
        \State \Return \( x^\ast \)
    \end{algorithmic}
\end{algorithm}

We have errors \begin{align*}
    e_1 & = | m_1 - x^\ast | \leq \frac{1}{2} ( R_1 - L_1 )
    \\
    e_2 & = | m_2 - x^\ast | \leq \frac{1}{2} ( R_2 - L_2 )
    = \frac{1}{4} ( R_1 - L_1 )
    \\
        & \vdots
    \\
    e_n & = | m_n - x^\ast | \leq \frac{1}{2^n} ( R_1 - L_1 )
\end{align*}

\begin{itemize}
    \item \textbf{Pros}
          \begin{itemize}
              \item Easy to implement
              \item Given interval bracket of root, guaranteed to converge (not often true for other methods)
              \item Only require knowledge of \( f(x) \), and not derivatives.
          \end{itemize}

    \item \textbf{Cons}
          \begin{itemize}
              \item Finding an interval bracket can be hard
              \item Convergence is slow, and convergence behaviour is not uniform
              \item Does not make use of much information about \( f(x) \)
          \end{itemize}
\end{itemize}

\begin{example}
    Suppose we want to find the root of \[
        f(x) = x - 0.2 \sin(x) - 0.5
    \] with absolute error \( | x_i - x^\ast | \leq 5 \times 10^{-7} \).

    How many iterations is required to achieve this error?

    Recall that we are given \[
        e_n \leq \frac{1}{2^n} ( R_1 - L_1 )
    \] and thus \[
        e_n \leq \frac{1}{2^n} (1 - 0) \leq 5 \times 10^{-7}
    \] We solve for \( n \) to get \begin{align*}
        2^n
         & \geq 0.2 \times 10^7
        \\
        n
         & \geq \log_2 \left( 0.2 \times 10^7 \right) \doteq 20.93
    \end{align*}
    Thus, we need at least 21 iterations.
\end{example}

\section{Fixed Point Iteration}

\begin{note}
    The problem of finding \( x^\ast \) such that \( f(x^\ast) = 0 \) is equivalent to the problem of finding \( x = p^\ast \) such that \( g(p^\ast) = p^\ast \) where \( g(x) = x - f(x) \).
\end{note}

\begin{definition}[Fixed Point]\index{Fixed Point}
    A point \( p^\ast \) is called a \term{fixed point} of a function \( g(x) \) if and only if \( g(p^\ast) = p^\ast \).
\end{definition}

\begin{example}
    Consider \( g(x) = x^3 - x - 1 \).
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                    axis lines = middle,
                    xlabel = \( x \),
                    ylabel = \( g(x) \),
                    xmin = -2, xmax = 2,
                    ymin = -2, ymax = 2,
                ]
                \addplot[domain=-2:2, samples=100, color=blue]{x^3 - x - 1};
                \addplot[domain=-2:2, samples=100, color=red]{x};
            \end{axis}
        \end{tikzpicture}
        \caption{Graph of \( g(x) = x^3 - x - 1 \). The fixed points of \( g \) are the points on \( g \) intersecting the line \( y = x \).}
    \end{figure}
\end{example}

How do we find the fixed point of a function? We could use either fixed point iteration or function iteration.

\subsection{Fixed Point Iteration}

Define the sequence \[
    x_0 \text{ given } \qquad x_{i+1} = g(x_i)
\] for \( i = 0, 1, 2, \dots \).

If it converges, then \[
    \lim_{i \to \infty} x_i = x^\ast
\]

\begin{note}
    Unlike bisection method, we do not have a guarantee of convergence.
\end{note}

\begin{example}
    Find a root of \[
        f(x) = x - 0.2 \sin (x) - 0.5
    \]

    Via the bisection method, we get a root at \( x^\ast \doteq 0.6514685 \) in 21 iterations.

    We now use the fixed point iteration method to find the root.

    Define \[
        g(x) = 0.2 \sin(x) + 0.5 \qquad f(x) = x - g(x)
    \] and we apply functional iteration to this \( g(x) \) with \( x_0 = 0 \).

    We compute \[
        x_0 = 0 \qquad x_{i+1}
        \qquad
        x_{i+1} = g(x_i)
    \] until \[
        | x_{i+1} - x_i | \leq 5 \times 10^{-7}
    \]

    \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c}
            \( i \) & \( x_i \)             & \( | x_i - x_{i-1} | \)
            \\ \hline
            0       & \texttt{0.000000E+00} &                         \\
            1       & \texttt{5.000000E-01} & \texttt{5.0e-01}        \\
            2       & \texttt{5.958851E-01} & \texttt{9.6E-02}        \\
            3       & \text{6.122483e-01}   & \texttt{1.6E-02}        \\
            4       & \text{6.149418e-01}   & \texttt{2.7E-03}        \\
            5       & \text{6.153822e-01}   & \texttt{4.4E-04}        \\
            6       & \text{6.154541e-01}   & \texttt{7.2E-05}        \\
            7       & \text{6.154659e-01}   & \texttt{1.2E-05}        \\
            8       & \text{6.154678e-01}   & \texttt{1.9E-06}        \\
            9       & \text{6.154681e-01}   & \texttt{3.1E-07}
        \end{tabular}
    \end{table}
\end{example}

\begin{remark}
    The value of \( x_0 \) may affect the number of iterations required to converge.

    \begin{table}[H]
        \centering
        \begin{tabular}{c|c}
            \( x_0 \)   & Steps to Convergence
            \\ \hline
            \( 1 \)     & 9
            \\
            \( -1 \)    & 10
            \\
            \( 10 \)    & 10
            \\
            \( -100 \)  & 7
            \\
            \( 1000 \)  & 9
            \\
            \( -1000 \) & 10
        \end{tabular}
    \end{table}
\end{remark}

% TODO: Plot

\begin{example}
    Use fixed point iteration to find the root of \[
        f(x) = x^3 - x - 1
    \]
    We note that \[
        f(x) = (x^3 - 1) - x
    \] Define \[
        g(x) = x^3 - 1
    \] and we try fixed iteration on \( g(x) \) from \( x_0 = 1 \).

    \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c}
            \( i \) & \( x_i \)               & \( | x_i - x_{i-1} | \) \\ \hline
            0       & \texttt{1.000000e+00}   &                         \\
            1       & \texttt{0.000000e+00}   & \texttt{1.0e+00}        \\
            2       & \texttt{-1.000000e+00}  & \texttt{1.0e+00}        \\
            3       & \texttt{-2. 000000e+00} & \texttt{1.0e+00}        \\
            4       & \texttt{-9.000000e+00}  & \texttt{7.0e+00}        \\
            5       & \texttt{-7.300000e+02}  & \texttt{7.2e+02}        \\
            6       & \texttt{-3.890170e+08}  & \texttt{3.9e+08}        \\
            7       & \texttt{-5.887159e+25}  & \texttt{5.9e+25}        \\
            8       & \texttt{-2.040409e+77}  & \texttt{2.0e+77}        \\
            9       & \texttt{-8.494771e+231} & \texttt{8.5e+231}
        \end{tabular}
    \end{table}
\end{example}